<%- include('../partials/header') %>

<div class="container my-4">

  <% if (!lesson) { %>
    <div class="alert alert-danger text-center">
      Lesson not found or unavailable.
    </div>
  <% } else { %>

    <!-- LESSON CARD -->
    <div class="card shadow-sm">
      <div class="card-body">

        <!-- TITLE -->
        <h2 class="fw-bold mb-2"><%= lesson.title %></h2>

        <!-- META INFO -->
        <p class="text-muted small mb-3">
          <strong>Subject:</strong> <%= lesson.subject %> &middot;
          <strong>Class:</strong> <%= lesson.classRef ? lesson.classRef.classNumber : 'N/A' %> &middot;
          <strong>Type:</strong> <%= lesson.lessonType %> &middot;
          <strong>Difficulty:</strong> <%= lesson.difficultyLevel %> <br>
          <strong>Uploaded:</strong> <%= new Date(lesson.createdAt).toLocaleString() %>

          <% if (lesson.uploadedBy) { %>
            &middot; <strong>By:</strong> <%= lesson.uploadedBy.name %>
          <% } %>
        </p>

        <hr>

        <!-- CONTENT -->
        <div class="mt-3" style="white-space: pre-wrap;">
          <%= lesson.content %>
        </div>

        <!-- RESOURCES -->
        <% if (lesson.resources && lesson.resources.length > 0) { %>
          <hr>
          <h5 class="fw-semibold mt-3">üìé Resources</h5>
          <ul>
            <% lesson.resources.forEach(r => { %>
              <li><a href="<%= r %>" target="_blank"><%= r %></a></li>
            <% }) %>
          </ul>
        <% } %>

      </div>
    </div>

    <div class="mt-3">
      <a href="/student/lessons" class="btn btn-outline-secondary btn-sm">‚Üê Back to Lessons</a>
    </div>

  <% } %>

</div>

<%- include('../partials/footer') %>
