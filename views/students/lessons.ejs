<%- include('../partials/header') %>

<div class="container mt-4">

  <!-- HEADER + FILTER -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold">ðŸ“š Lessons</h2>

    <!-- CLASS FILTER DROPDOWN -->
    <form method="GET" action="/student/lessons">
      <select name="class" class="form-select form-select-sm" onchange="this.form.submit()">

        <option value="">All Classes</option>

        <% classes.forEach(cls => { %>
          <option value="<%= cls._id %>"
            <%= selectedClass == cls._id ? "selected" : "" %>>
            Class <%= cls.classNumber %>
          </option>
        <% }) %>

      </select>
    </form>
  </div>

  <% if (!lessons || lessons.length === 0) { %>

    <p class="text-muted text-center">No lessons available.</p>

  <% } else { %>

    <div class="row g-3">

      <% lessons.forEach(lesson => { %>
        <div class="col-md-4">

          <div class="card h-100 shadow-sm">
            <div class="card-body">

              <h5 class="card-title">
                <%= lesson.title %>
              </h5>

              <p class="text-muted small mb-1">
                <strong>Subject:</strong> <%= lesson.subject %>
              </p>

              <p class="text-muted small mb-2">
                <strong>Class:</strong>
                <%= lesson.classRef ? lesson.classRef.classNumber : "N/A" %>
              </p>

              <p class="card-text">
                <%= lesson.content.substring(0, 80) %>...
              </p>

              <a href="/student/lesson/<%= lesson._id %>" class="btn btn-primary btn-sm">
                View Lesson
              </a>

            </div>
          </div>

        </div>
      <% }) %>

    </div>

  <% } %>

</div>

<%- include('../partials/footer') %>
